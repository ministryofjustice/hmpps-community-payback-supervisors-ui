{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% extends "../partials/layout.njk" %}

{% set pageTitle = project.projectName %}
{% set mainClasses = "app-container govuk-body" %}

{% block beforeContent %}
  {{ govukBackLink({
    text: "Back",
    href: '/'
  }) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">Session details</h1>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div data-cy="project-details" class="govuk-notification-banner cpb-border-grey" aria-labelledby="govuk-notification-banner-title">
      <div class="govuk-notification-banner__header cpb-bg-grey">
        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
          {{ session.formattedDate }}
        </h2>
      </div>
      <div class="govuk-notification-banner__content">
        <h3 class="govuk-notification-banner__heading">
          {{ session.projectName }}
        </h3>
        <p class="govuk-body">{{ session.formattedLocation | escape | nl2br }}</p>
      </div>
    </div>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h2>
      {{ session.appointmentSummaries.length }} people scheduled on this session
    </h2>
    
    <ul class="govuk-list">
      {% for appointment in session.appointmentSummaries %}
        {% set offenderName = appointment.formattedOffender.name | default(appointment.formattedOffender.crn) %}
        <li>
          <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
              <h3 class="govuk-summary-card__title">
                {{ offenderName }}
              </h3>

              <div class="govuk-summary-card__actions">
                <div class="govuk-summary-card__action">
                  <a class="govuk-link" href="{{ appointment.path }}">View details<span class="govuk-visually-hidden"> of {{ offenderName }}</span></a>
                </div>
              </div>
            </div>
            <div class="govuk-summary-card__content">
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

{% endblock %}
